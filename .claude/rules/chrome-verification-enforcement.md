# Chrome验证强制执行规范

**生效日期**: 2025-12-31
**定级**: CRITICAL - Check阶段强制关卡
**目标**: 确保修复的实际效果，而非仅代码正确性

---

## 核心原则

> **没有Chrome验证报告 = Pull Request无法合并 = Issue无法关闭**

---

## Check阶段流程图

```
修复代码完成
    ↓
npm run build & preview ✅
    ↓
推送到GitHub，创建PR
    ↓
Code Review 通过 ✅
    ↓
GitHub Actions 部署成功 ✅
    ↓
🛑 MANDATORY Chrome Verification
    ├─ 访问生产URL
    ├─ 执行测试步骤
    ├─ 收集BEFORE/AFTER截屏
    ├─ 验证副作用
    ├─ 生成验证报告
    └─ 没有通过 = 返回Do阶段修复
    ↓
验证报告发布到Issue ✅
    ↓
可以合并PR、关闭Issue
```

---

## 验证报告的标准格式

### 模板（复制粘贴使用）

```markdown
## Chrome 生产环境验证报告

**Issue**: #[number]
**修复内容**: [简述修复是什么]
**验证时间**: [时间戳]

### 验证环境

| 项目 | 值 |
|------|-----|
| URL | https://youngger9765.github.io/WordGym-students-merge/ |
| 浏览器 | Chrome [版本号] |
| 操作系统 | [OS名称和版本] |
| 屏幕分辨率 | [分辨率] |
| 缓存清理 | ✅ 已清理 (Ctrl+Shift+Delete) |
| 硬刷新 | ✅ 已执行 (Ctrl+Shift+R) |

### 复现步骤

修复前的复现步骤（从Issue中复制）：
1. [步骤1]
2. [步骤2]
3. [步骤3]

### 验证结果

#### 修复前 (BEFORE)
[上传BEFORE截屏]

**问题现象**:
- [描述问题1]
- [描述问题2]

**数据统计** (如适用):
- [统计项1]
- [统计项2]

**Console状态**:
- Errors: [无/列表]
- Warnings: [无/列表]

#### 修复后 (AFTER)
[上传AFTER截屏]

**修复结果**:
- [修复项1]: ✅ 已解决
- [修复项2]: ✅ 已解决

**数据统计** (如适用):
- [统计项1]
- [统计项2]

**Console状态**:
- Errors: ✅ 无错误
- Warnings: ✅ 无警告

### 对比分析

| 项 | 修复前 | 修复后 | 结论 |
|---|-------|-------|------|
| 问题现象 | [情况] | [情况] | ✅ 已解决 / ❌ 仍存在 |
| 性能 | [X ms] | [Y ms] | ✅ 正常 / ⚠️ [描述] |
| Console错误 | [数量] | [数量] | ✅ 无增加 / ❌ 有增加 |

### 副作用检查

测试以下功能是否受影响：

- [ ] 功能A: ✅ 正常 / ⚠️ 部分受影响 / ❌ 损坏
- [ ] 功能B: ✅ 正常 / ⚠️ 部分受影响 / ❌ 损坏
- [ ] 功能C: ✅ 正常 / ⚠️ 部分受影响 / ❌ 损坏

**副作用说明** (如有):
- [副作用1]: [描述]
- [副作用2]: [描述]

### 性能指标

使用Chrome DevTools Network标签检查：

```
页面加载时间: ~[Xms]
首屏加载: ~[Yms]
最大内容绘制 (LCP): ~[Zms]
```

### 最终结论

**验证状态**:
- ✅ **PASS** - 问题已解决，无副作用
- ⚠️ **PARTIAL PASS** - 主要问题已解决，但有以下副作用: [列表]
- ❌ **FAIL** - [失败原因]

**如果失败**，需要返回Do阶段修复：
- [ ] 原因: [描述]
- [ ] 下一步: [修复计划]

### 验证者签名

AI Agent: [Agent名称]
时间戳: [ISO 8601格式]
验证步骤: [链接到本文档]
```

---

## Issue类型特定的验证清单

### 1. UI/样式问题检查

**示例Issues**: #26 (样式不一致)

**必须验证的清单**:

```markdown
### UI/样式验证清单

#### 基础样式
- [ ] 颜色是否正确
- [ ] 间距是否一致
- [ ] 字体大小是否合适
- [ ] 对齐是否正确

#### 响应式设计
- [ ] 375px (手机竖屏)
- [ ] 768px (平板竖屏)
- [ ] 1024px (平板横屏)
- [ ] 1280px (笔记本)
- [ ] 1920px (桌面)

#### 浏览器兼容性
- [ ] Chrome 最新版本
- [ ] Safari (如可用)
- [ ] Firefox (如可用)

#### 动态交互
- [ ] 悬停效果 (如有)
- [ ] 点击反馈 (如有)
- [ ] 过渡动画 (如有)
- [ ] 加载状态 (如有)

#### 性能
- [ ] 没有layout shift (CLS)
- [ ] 动画是否流畅 (60fps)
- [ ] 没有jank或延迟
```

### 2. 数据过滤问题检查

**示例Issues**: #31 (国中/高中混合)

**必须验证的清单**:

```markdown
### 数据过滤验证清单

#### 数据分离
- [ ] 选择"国中" → 只显示国中词
  - 数量: [统计]
  - 有无高中词: ✅ 无 / ❌ 有

- [ ] 选择"高中" → 只显示高中词
  - 数量: [统计]
  - 有无国中词: ✅ 无 / ❌ 有

#### 数据完整性
- [ ] 修复前词数: [X]
- [ ] 修复后词数: [Y]
- [ ] 差异分析: [描述]
- [ ] 是否合理: ✅ 是 / ❌ 否

#### 边界情况
- [ ] 切换多次是否一致
- [ ] 页面刷新是否保持
- [ ] 浏览器后退是否正常
- [ ] 搜索+过滤组合是否正常

#### 性能
- [ ] 大数据量时响应时间
- [ ] 过滤切换是否卡顿
- [ ] 内存使用是否合理
```

### 3. 功能/级联问题检查

**示例Issues**: #25 (冊次级联)

**必须验证的清单**:

```markdown
### 功能级联验证清单

#### 单个功能
- [ ] 功能A单独运作: ✅ / ❌
- [ ] 功能B单独运作: ✅ / ❌
- [ ] 功能C单独运作: ✅ / ❌

#### 级联触发
- [ ] 修改A → B自动更新: ✅ / ❌
- [ ] 修改B → C自动更新: ✅ / ❌
- [ ] 修改C → A不受影响: ✅ / ❌

#### 状态一致性
- [ ] 初始状态: ✅ 正确 / ❌ 错误
- [ ] 修改后: ✅ 正确 / ❌ 错误
- [ ] 页面刷新: ✅ 状态保持 / ❌ 状态丢失
- [ ] 浏览器后退: ✅ 状态恢复 / ❌ 状态错误

#### 多个条件组合
- [ ] A + B: ✅ 正常 / ❌ 出错
- [ ] A + B + C: ✅ 正常 / ❌ 出错
- [ ] 其他组合: [列出测试的组合]

#### 性能
- [ ] 级联更新是否及时
- [ ] 是否有竞态条件
- [ ] 大数据量时是否卡顿
```

### 4. 显示内容问题检查

**示例Issues**: #27 (例句恢复)

**必须验证的清单**:

```markdown
### 内容显示验证清单

#### 内容完整性
- [ ] 例句1是否显示
- [ ] 例句2是否显示
- [ ] 例句3是否显示
- [ ] 例句4是否显示
- [ ] 例句5是否显示
- [ ] 翻译是否显示
- [ ] 其他元素是否完整

#### 布局正确性
- [ ] 内容是否溢出
- [ ] 换行是否适当
- [ ] 字体大小是否合理
- [ ] 间距是否均衡
- [ ] 对齐是否正确

#### 响应式表现
- [ ] 手机竖屏是否正常
- [ ] 手机横屏是否正常
- [ ] 平板是否正常
- [ ] 桌面是否正常

#### 性能
- [ ] 内容加载时间
- [ ] 没有文本闪烁
- [ ] 没有FOUC (Flash of Unstyled Content)
```

---

## 截屏指南

### 如何获取BEFORE截屏

1. **在生产环境中重现问题**
   ```
   访问: https://youngger9765.github.io/WordGym-students-merge/
   按照Issue中的复现步骤操作
   ```

2. **清除浏览器缓存**
   ```
   Ctrl+Shift+Delete (Windows/Linux)
   Cmd+Shift+Delete (Mac)
   选择 "清空缓存" 和 "Cookie及其他网站数据"
   ```

3. **刷新页面**
   ```
   Ctrl+Shift+R 或 Cmd+Shift+R
   ```

4. **截屏**
   ```
   Ctrl+Shift+S (Windows)
   Cmd+Shift+4 (Mac)
   或使用Chrome DevTools的截屏功能
   ```

### 如何获取AFTER截屏

1. **等待修复部署**
   - 合并PR后
   - 等待GitHub Actions完成
   - 检查Actions日志确认成功

2. **同样清除缓存和刷新**
   ```
   Ctrl+Shift+Delete
   Ctrl+Shift+R
   ```

3. **执行相同操作步骤**
   - 按照BEFORE的步骤重复
   - 确保在相同条件下对比

4. **截屏**
   ```
   同BEFORE的方式
   ```

### 截屏的技巧

**好的截屏**:
- ✅ 显示完整的问题/修复点
- ✅ 包括相关的UI元素
- ✅ 清晰可读
- ✅ 如需要，可以标注问题区域

**坏的截屏**:
- ❌ 只截屏问题的一小部分
- ❌ 太小看不清
- ❌ 没有足够的上下文
- ❌ 截屏过大（超过5MB）

### 在GitHub中上传截屏

1. 在Issue评论中点击图片图标
2. 或直接拖拽图片到评论框
3. 等待上传完成
4. 在评论中清晰标注 "BEFORE" 和 "AFTER"

---

## 特殊情况处理

### 情况1: 问题难以通过静态截屏验证

**例**: 动画、交互、或性能问题

**处理方式**:
- 使用Chrome DevTools录制视频
- 或提供操作步骤的详细描述
- 并在Console中截屏关键数据

### 情况2: 问题只在特定条件下出现

**例**: 特定设备尺寸或浏览器

**处理方式**:
- 说明需要的条件
- 提供该条件下的截屏
- 解释为什么其他条件不受影响

### 情况3: 修复跨越多个页面或功能

**例**: 修复影响整个应用

**处理方式**:
- 分别验证各个受影响的页面
- 创建验证清单
- 为每个关键功能提供BEFORE/AFTER

### 情况4: 性能问题修复

**例**: 优化加载时间

**处理方式**:
- 使用Chrome DevTools Network标签测量
- 提供Load time数据对比
- 截屏Network标签的结果

---

## 验证失败时的处理

### 失败情况1: 问题仍然存在

```
客户说: "还是没有修复"
验证: AFTER截屏仍显示问题
↓
处理:
1. 分析失败原因
2. 返回Do阶段
3. 检查修复代码是否部署
4. 分析为什么修复无效
5. 实施新的修复
6. 重新验证
```

### 失败情况2: 修复产生了新问题

```
验证: 主问题解决，但副作用检查失败
↓
处理:
1. 在Issue中记录新问题
2. 分析副作用的原因
3. 改进修复以避免副作用
4. 或将副作用作为已知问题记录
```

### 失败情况3: 某些场景下仍有问题

```
验证: 大多数情况正常，但特定场景失败
↓
处理:
1. 明确记录问题场景
2. 更新Issue描述，说明部分修复
3. 或返回Do阶段进行完整修复
```

---

## 持续改进

### 验证报告的反馈

每次验证后：
- [ ] 记录验证所花时间
- [ ] 如有困难，记录原因
- [ ] 如有新发现，更新清单

### 优化验证流程

定期回顾：
- 验证清单是否完整？
- 是否需要添加新的检查项？
- 最常遇到的问题是什么？

### 建立验证知识库

收集：
- 各类Issue的验证最佳实践
- 常见问题的诊断方法
- 验证工具和技巧

---

## 总结

**Chrome验证强制执行的三个原则**:

1. **完整性**: 没有截屏 = 验证不完整
2. **一致性**: 各个Issue遵循相同的验证流程
3. **有效性**: 验证能真实反映用户体验

**核心检查**:
- ✅ 问题是否解决？
- ✅ 有新问题吗？
- ✅ 性能是否受影响？
- ✅ 其他功能是否正常？

**没有通过Chrome验证 = Issue不能关闭**

---

*规范生效日期: 2025-12-31 | 所有修复必须遵循此强制流程*
